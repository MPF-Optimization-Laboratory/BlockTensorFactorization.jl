<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Block Update Order · BlockTensorFactorization.jl</title><meta name="title" content="Block Update Order · BlockTensorFactorization.jl"/><meta property="og:title" content="Block Update Order · BlockTensorFactorization.jl"/><meta property="twitter:title" content="Block Update Order · BlockTensorFactorization.jl"/><meta name="description" content="Documentation for BlockTensorFactorization.jl."/><meta property="og:description" content="Documentation for BlockTensorFactorization.jl."/><meta property="twitter:description" content="Documentation for BlockTensorFactorization.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">BlockTensorFactorization.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quickguide/">Quick Guide</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../decompositionmodels/">Decomposition Models</a></li><li><a class="tocitem" href="../constraints/">Constrained Factorization</a></li><li class="is-active"><a class="tocitem" href>Block Update Order</a><ul class="internal"><li><a class="tocitem" href="#Randomizing-Block-Updates-Order"><span>Randomizing Block Updates Order</span></a></li></ul></li><li><a class="tocitem" href="../iterationstats/">Iteration Stats</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../reference/constants/">Constants</a></li><li><a class="tocitem" href="../../reference/types/">Types</a></li><li><a class="tocitem" href="../../reference/functions/">Functions</a></li></ul></li><li><span class="tocitem">Deprecated</span><ul><li><a class="tocitem" href="../../deprecated/densityestimationtools/">Density Estimation Tools</a></li><li><a class="tocitem" href="../../deprecated/matrixtensorfactor/">Matrix Tensor Factor</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorial</a></li><li class="is-active"><a href>Block Update Order</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Block Update Order</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MPF-Optimization-Laboratory/BlockTensorFactorization.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MPF-Optimization-Laboratory/BlockTensorFactorization.jl/blob/main/docs/src/tutorial/blockupdateorder.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Block-Update-Order"><a class="docs-heading-anchor" href="#Block-Update-Order">Block Update Order</a><a id="Block-Update-Order-1"></a><a class="docs-heading-anchor-permalink" href="#Block-Update-Order" title="Permalink"></a></h1><p>The default order the blocks are updated is cyclically through each factor of the decomposition <code>D::AbstractDecomposition</code>, in the order of <code>factors(D)</code>. For <code>AbstractTucker</code> decompositions like Tucker, Tucker-1, and CP, this means starting with the core, followed by the matrix factor for the first dimension, second dimension, and so on.</p><p>As an example, this would be the default order of updates for nonnegative CP decomposition on an order 3 tensor.</p><pre><code class="language-julia hljs">BlockedUpdate(
    MomentumUpdate(1, lipschitz)
    GradientStep(1, gradient, LipschitzStep)
    Projection(1, Entrywise(ReLU, isnonnegative))
    MomentumUpdate(2, lipschitz)
    GradientStep(2, gradient, LipschitzStep)
    Projection(2, Entrywise(ReLU, isnonnegative))
    MomentumUpdate(3, lipschitz)
    GradientStep(3, gradient, LipschitzStep)
    Projection(3, Entrywise(ReLU, isnonnegative))
)</code></pre><h2 id="Randomizing-Block-Updates-Order"><a class="docs-heading-anchor" href="#Randomizing-Block-Updates-Order">Randomizing Block Updates Order</a><a id="Randomizing-Block-Updates-Order-1"></a><a class="docs-heading-anchor-permalink" href="#Randomizing-Block-Updates-Order" title="Permalink"></a></h2><p>The order of updates can be randomized with the <code>random_order</code> keyword.</p><pre><code class="language-julia hljs">X, stats, kwargs = factorize(Y; random_order=true)</code></pre><p>By default, this will keep momentum steps, gradient steps, and constraint steps for each factor together as a block, in this order.</p><p>A possible order of updates could be the following. Note that the updates for each factor are grouped together, but each factor is updated in a random order.</p><pre><code class="language-julia hljs">BlockedUpdate(
    BlockedUpdate(
        MomentumUpdate(2, lipschitz)
        GradientStep(2, gradient, LipschitzStep)
        Projection(2, Entrywise(ReLU, isnonnegative))
    )
    BlockedUpdate(
        MomentumUpdate(1, lipschitz)
        GradientStep(1, gradient, LipschitzStep)
        Projection(1, Entrywise(ReLU, isnonnegative))
    )
    BlockedUpdate(
        MomentumUpdate(3, lipschitz)
        GradientStep(3, gradient, LipschitzStep)
        Projection(3, Entrywise(ReLU, isnonnegative))
    )
)</code></pre><p>For more randomization, use the <code>recursive_random_order</code> keyword which will also randomize the order in which the momentum steps, gradient steps, and constraint steps are performed.</p><pre><code class="language-julia hljs">X, stats, kwargs = factorize(Y; recursive_random_order=true)</code></pre><p>A possible order of updates could now be the following. The updates for each factor are still grouped together, but the updates within each block appear in a random order.</p><pre><code class="language-julia hljs">BlockedUpdate(
    BlockedUpdate(
        Projection(2, Entrywise(ReLU, isnonnegative))
        MomentumUpdate(2, lipschitz)
        GradientStep(2, gradient, LipschitzStep)
    )
    BlockedUpdate(
        MomentumUpdate(1, lipschitz)
        Projection(1, Entrywise(ReLU, isnonnegative))
        GradientStep(1, gradient, LipschitzStep)
    )
    BlockedUpdate(
        GradientStep(3, gradient, LipschitzStep)
        Projection(3, Entrywise(ReLU, isnonnegative))
        MomentumUpdate(3, lipschitz)
    )
)</code></pre><p>The opposite of this would be to keep the outer order of blocks as given, but randomize the order which the updates for each factor gets applied, use the following code.</p><pre><code class="language-julia hljs">X, stats, kwargs = factorize(Y; recursive_random_order=true, random_order=false, group_by_factor=true)</code></pre><p>A possible order of updates could now be the following. Note the order of factors is preserved (1, 2, 3) but the inner <code>BlockedUpdate</code>s have a random order.</p><pre><code class="language-julia hljs">BlockedUpdate(
    BlockedUpdate(
        Projection(1, Entrywise(ReLU, isnonnegative))
        MomentumUpdate(1, lipschitz)
        GradientStep(1, gradient, LipschitzStep)
    )
    BlockedUpdate(
        MomentumUpdate(2, lipschitz)
        Projection(2, Entrywise(ReLU, isnonnegative))
        GradientStep(2, gradient, LipschitzStep)
    )
    BlockedUpdate(
        GradientStep(3, gradient, LipschitzStep)
        MomentumUpdate(3, lipschitz)
        Projection(3, Entrywise(ReLU, isnonnegative))
    )
)</code></pre><p>Note all the previously mentioned options still keeps the various updates for each factor together. For full randomization, use the following code.</p><pre><code class="language-julia hljs">X, stats, kwargs = factorize(Y; recursive_random_order=true, group_by_factor=false)</code></pre><p>A possible order of updates could now be the following. Note that every update can appear anywhere in the order.</p><pre><code class="language-julia hljs">BlockedUpdate(
    Projection(3, Entrywise(ReLU, isnonnegative))
    MomentumUpdate(2, lipschitz)
    GradientStep(2, gradient, LipschitzStep)
    MomentumUpdate(1, lipschitz)
    GradientStep(1, gradient, LipschitzStep)
    Projection(2, Entrywise(ReLU, isnonnegative))
    MomentumUpdate(3, lipschitz)
    MomentumUpdate(2, lipschitz)
    Projection(1, Entrywise(ReLU, isnonnegative))
    GradientStep(3, gradient, LipschitzStep)
)</code></pre><p>The complete behaviour is summarized in the table below. | <code>group_by_factor</code> | <code>random_order</code> | <code>recursive_random_order</code> | Description                                                                 | |–––––––––-|––––––––|–––––––––––––|––––––––––––––––––––––––––––––––––––––-| | <code>false</code>           | <code>false</code>        | <code>false</code>                  | In the order given                                                          | | <code>false</code>           | <code>false</code>        | <code>true</code>                   | In order given, but randomize how existing blocks are ordered (recursively) | | <code>false</code>           | <code>true</code>         | <code>false</code>                  | Randomize updates, but keep existing blocks in order                        | | <code>false</code>           | <code>true</code>         | <code>true</code>                   | Fully random                                                                | | <code>true</code>            | <code>false</code>        | <code>false</code>                  | In the order given                                                          | | <code>true</code>            | <code>false</code>        | <code>true</code>                   | In order of factors, but updates for each factor a random order             | | <code>true</code>            | <code>true</code>         | <code>false</code>                  | Random order of factors, preserve order of updates within each factor       | | <code>true</code>            | <code>true</code>         | <code>true</code>                   | Almost fully random, but updates for each factor are done together          |</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../constraints/">« Constrained Factorization</a><a class="docs-footer-nextpage" href="../iterationstats/">Iteration Stats »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Thursday 13 November 2025 23:25">Thursday 13 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
